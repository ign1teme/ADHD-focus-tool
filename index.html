<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“æ³¨æµè§ˆå™¨ - ADHD Focus Browser</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* ä¸“æ³¨æ¨¡å¼ - å†·è‰²è°ƒ */
            --primary: #5B8FB9;
            --secondary: #2C3E50;
            --accent: #5DADE2;
            --warning: #FF6B6B;
            --bg-dark: #1a1a2e;
            --bg-light: #2C3E50;
            --text: #eaeaea;
            --text-muted: #95a5a6;
        }

        body.rest-mode {
            /* ä¼‘æ¯æ¨¡å¼ - æš–è‰²è°ƒ */
            --primary: #E67E22;
            --secondary: #D35400;
            --accent: #52C788;
            --bg-dark: #1e2a1a;
            --bg-light: #2d4a2d;
            --text-muted: #a8b89a;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
        }

        /* ========== å››çŠ¶æ€ç³»ç»Ÿæ ·å¼ ========== */
        /* çŠ¶æ€ç‰¹å®šçš„bodyç±» */
        body.state-idle {
            /* ç©ºé—²æ€ï¼šé»˜è®¤æ ·å¼ */
        }

        body.state-pre-focus {
            /* å‡†å¤‡æ€ï¼šèƒŒæ™¯ç¨å¾®å˜æš— */
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(44, 62, 80, 0.95));
        }

        body.state-flow {
            /* å¿ƒæµæ€ï¼šå…¨å±æ²‰æµ¸ */
            background: #0a0a14;
        }

        body.state-pause {
            /* æš‚åœæ€ï¼šç£¨ç ‚ç»ç’ƒæ•ˆæœ */
            background: var(--bg-dark);
        }

        /* ä¾§è¾¹æ çŠ¶æ€ */
        .sidebar.dimmed {
            opacity: 0.3;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        /* è®¡æ—¶å™¨æš‚åœçŠ¶æ€ */
        .timer-display.timer-paused {
            animation: timerFlash 1s infinite;
            color: #FF6B6B;
        }

        @keyframes timerFlash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* è®¡æ—¶å™¨æç®€æ¨¡å¼ */
        .timer-minimal .timer-circle-svg {
            display: none;
        }

        .timer-minimal .timer-display {
            font-size: 5rem;
            margin: 20px 0;
        }

        /* æš‚åœçŠ¶æ€çš„èƒŒæ™¯æ¨¡ç³Š */
        body.state-pause .main-content {
            backdrop-filter: blur(5px);
        }

        /* ========== éš§é“æ•ˆåº”åŠ¨ç”» ========== */
        /* è¿›å…¥FLOWçŠ¶æ€æ—¶çš„åŠ¨ç”» */
        .container.transitioning-to-flow {
            animation: tunnelEffect 0.8s ease-out;
        }

        @keyframes tunnelEffect {
            from {
                transform: scale(1);
            }
            to {
                transform: scale(1.05);
            }
        }

        /* ä¾§è¾¹æ æ»‘å‡ºåŠ¨ç”» */
        .sidebar.sliding-out {
            animation: slideOutLeft 0.8s ease-out forwards;
        }

        @keyframes slideOutLeft {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(-100%);
                opacity: 0;
            }
        }

        /* å½“å‰ç›®æ ‡æ”¾å¤§åŠ¨ç”» */
        .focus-current-goal.zooming-in {
            animation: zoomIn 0.8s ease-out forwards;
        }

        @keyframes zoomIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* ä¾§è¾¹æ è¾¹ç¼˜ç‚¹è„‰å†²åŠ¨ç”» */
        .sidebar-dot {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(93, 173, 226, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(93, 173, 226, 0);
            }
        }

        /* æ·¡å…¥åŠ¨ç”» */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ç²’å­ç‰¹æ•ˆç”»å¸ƒ */
        #celebrationCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            display: none;
        }

        .container {
            display: grid;
            grid-template-columns: 280px 1fr;
            height: 100vh;
            transition: grid-template-columns 0.3s ease;
        }

        .container.sidebar-collapsed {
            grid-template-columns: 0px 1fr;
        }

        /* ä¾§è¾¹æ æ ·å¼ */
        .sidebar {
            background: var(--bg-light);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            overflow-x: hidden;
            border-right: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }

        .sidebar.collapsed {
            width: 0;
            padding: 0;
            opacity: 0;
        }

        .logo {
            text-align: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo h1 {
            font-size: 1.3rem;
            color: var(--accent);
        }

        .logo p {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        /* ç•ªèŒ„é’Ÿæ ·å¼ - ä¸­å¿ƒä½ç½® */
        .timer-section-center {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .timer-section-center .timer-circle-container {
            width: 280px;
            height: 280px;
            margin: 0;
        }

        .timer-section-center .timer-circle-svg {
            width: 100%;
            height: 100%;
        }

        .timer-section-center .timer-display {
            font-size: 4rem;
        }

        .timer-section-center .timer-label {
            font-size: 1.2rem;
            color: var(--text-muted);
            margin-bottom: 0;
        }

        .timer-section-center .timer-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .timer-section-center .timer-presets {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        /* ä¸“æ³¨æ¨¡å¼ä¸‹çš„å½“å‰ç›®æ ‡æ˜¾ç¤º */
        .focus-current-goal {
            display: none;
            text-align: center;
            max-width: 600px;
            padding: 30px;
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            border: 2px solid var(--accent);
        }

        body.focus-mode .focus-current-goal {
            display: block;
        }

        .focus-goal-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .focus-goal-text {
            font-size: 1.8rem;
            color: var(--accent);
            font-weight: bold;
            line-height: 1.4;
            min-height: 2.5rem;
        }

        .timer-display {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
            font-variant-numeric: tabular-nums;
        }

        .timer-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        /* åœ†ç¯è¿›åº¦æ¡æ ·å¼ */
        .timer-circle-container {
            position: relative;
            width: 140px;
            height: 140px;
            margin: 10px auto;
        }

        .timer-circle-svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }

        .timer-circle-bg {
            fill: none;
            stroke: rgba(255,255,255,0.1);
            stroke-width: 8;
        }

        .timer-circle-progress {
            fill: none;
            stroke: var(--accent);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.3s linear;
        }

        .timer-display-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .timer-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent);
            color: #000;
        }

        .btn-primary:hover {
            background: #02a870;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-danger {
            background: var(--warning);
            color: #fff;
        }

        .btn-danger:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        /* ========== PRE-FOCUS å‡†å¤‡æ¸…å•æ ·å¼ ========== */
        .pre-focus-checklist {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 30px;
            padding: 40px;
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            border: 2px solid var(--accent);
            max-width: 500px;
            margin: 0 auto;
        }

        .pre-focus-checklist h2 {
            font-size: 1.8rem;
            color: var(--accent);
            margin: 0;
        }

        .checklist-items {
            list-style: none;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .checklist-items li {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            color: var(--text);
        }

        .checklist-items input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }

        .checklist-buttons {
            display: flex;
            gap: 15px;
            width: 100%;
            justify-content: center;
        }

        .checklist-buttons .btn {
            flex: 1;
            max-width: 150px;
            padding: 12px 24px;
            font-size: 1rem;
        }

        /* ========== å¿«æ·é“¾æ¥åˆ‡æ¢æŒ‰é’® ========== */
        .quick-links-toggle {
            padding: 10px 20px;
            background: var(--bg-light);
            border: 1px solid var(--accent);
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .quick-links-toggle:hover {
            background: var(--accent);
            color: #000;
            transform: translateY(-2px);
        }
        .task-section {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
        }

        .section-title {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .task-input-group {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .task-input {
            flex: 1;
            min-width: 0;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: var(--text);
            font-size: 0.85rem;
        }

        .task-input:focus {
            outline: 2px solid var(--accent);
        }

        .task-list {
            list-style: none;
            max-height: 150px;
            overflow-y: auto;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .task-item.completed {
            opacity: 0.5;
            text-decoration: line-through;
        }

        .task-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .task-delete {
            margin-left: auto;
            background: none;
            border: none;
            color: var(--warning);
            cursor: pointer;
            opacity: 0.6;
        }

        .task-delete:hover {
            opacity: 1;
        }

        /* å½“å‰ç›®æ ‡é«˜äº® */
        .current-goal {
            background: linear-gradient(135deg, var(--secondary), var(--bg-light));
            border-radius: 12px;
            padding: 15px;
            border-left: 4px solid var(--accent);
        }

        .current-goal input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: var(--text);
            font-size: 1rem;
            text-align: center;
        }

        .current-goal input:focus {
            outline: 2px solid var(--accent);
        }

        /* ç»Ÿè®¡åŒºåŸŸ */
        .stats-section {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        /* èƒ½é‡æ¡æ ·å¼ */
        .energy-bar-container {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .energy-bar-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .energy-bar-track {
            height: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .energy-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 10px;
            width: 0%;
            transition: width 1s ease-out;
            position: relative;
            overflow: hidden;
        }

        .energy-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* è¿èƒœè®°å½•æ ·å¼ */
        .streak-section {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
        }

        .streak-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .streak-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.3s;
        }

        .streak-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }

        .streak-icon {
            font-size: 2rem;
            line-height: 1;
        }

        .streak-info {
            flex: 1;
        }

        .streak-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
            line-height: 1;
        }

        .streak-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            gap: 30px;
            overflow-y: auto;
        }

        /* å‘¼å¸ç»ƒä¹  */
        .breathing-section {
            text-align: center;
        }

        .breathing-section h2 {
            color: var(--accent);
            margin-bottom: 10px;
        }

        .breathing-hint {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .breathing-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            transition: transform 4s ease-in-out;
            cursor: pointer;
        }

        .breathing-circle.inhale {
            transform: scale(1.5);
        }

        .breathing-circle.exhale {
            transform: scale(1);
        }

        #breathingText {
            color: #fff;
            font-weight: bold;
            font-size: 1rem;
        }

        /* æ¿€åŠ±è¯­å¥ - ä¾§è¾¹æ ç‰ˆæœ¬ */
        .sidebar .motivation-section {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .sidebar .motivation-quote {
            font-size: 0.9rem;
            color: var(--text);
            font-style: italic;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        /* å¿«æ·é“¾æ¥ - ä¾§è¾¹æ ç‰ˆæœ¬ */
        .sidebar .quick-links {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
        }

        .sidebar .links-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .sidebar .link-card {
            padding: 8px 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            color: var(--text);
            text-decoration: none;
            transition: all 0.2s;
            font-size: 0.85rem;
            text-align: center;
        }

        .sidebar .link-card:hover {
            background: var(--accent);
            color: #000;
        }

        /* ä¸“æ³¨æç¤º - ä¾§è¾¹æ ç‰ˆæœ¬ */
        .sidebar .focus-tips {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
        }

        .sidebar .focus-tips ul {
            list-style: none;
        }

        .sidebar .focus-tips li {
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* ä¾§è¾¹æ å‘¼å¸è®­ç»ƒæ ·å¼ */
        .sidebar-breathing {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            display: none;
        }

        body.rest-mode .sidebar-breathing {
            display: block;
        }

        .sidebar-breathing-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px auto;
            transition: transform 4s ease-in-out;
            cursor: pointer;
        }

        .sidebar-breathing-circle.inhale {
            transform: scale(1.3);
        }

        .sidebar-breathing-circle.exhale {
            transform: scale(1);
        }

        .sidebar-breathing-text {
            color: #fff;
            font-weight: bold;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="logo">
                <h1>ğŸ¯ ä¸“æ³¨æµè§ˆå™¨</h1>
                <p>ä¸º ADHD ç”¨æˆ·è®¾è®¡</p>
            </div>

            <!-- è¿èƒœè®°å½• -->
            <div class="streak-section sidebar-content">
                <div class="streak-grid">
                    <div class="streak-item">
                        <div class="streak-icon">ğŸ”¥</div>
                        <div class="streak-info">
                            <div class="streak-value" id="streakDays">0</div>
                            <div class="streak-label">è¿ç»­å¤©æ•°</div>
                        </div>
                    </div>
                    <div class="streak-item">
                        <div class="streak-icon">âš¡</div>
                        <div class="streak-info">
                            <div class="streak-value" id="todayStreak">0</div>
                            <div class="streak-label">ä»Šæ—¥è¿å‡»</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å½“å‰ç›®æ ‡ -->
            <div class="current-goal sidebar-content">
                <div class="section-title">ğŸ¯ å½“å‰ç›®æ ‡</div>
                <input type="text" id="currentGoal" placeholder="è¾“å…¥ä½ ç°åœ¨è¦ä¸“æ³¨åšçš„äº‹...">
            </div>

            <!-- ä»»åŠ¡åˆ—è¡¨ -->
            <div class="task-section sidebar-content">
                <div class="section-title">ğŸ“ å¾…åŠäº‹é¡¹</div>
                <div class="task-input-group">
                    <input type="text" class="task-input" id="taskInput" placeholder="æ·»åŠ ä»»åŠ¡...">
                    <button class="btn btn-primary" onclick="addTask()">+</button>
                </div>
                <ul class="task-list" id="taskList"></ul>
            </div>

            <!-- ç»Ÿè®¡ -->
            <div class="stats-section sidebar-content">
                <div class="section-title">ğŸ“Š ä»Šæ—¥ç»Ÿè®¡</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="pomodoroCount">0</div>
                        <div class="stat-label">å®Œæˆç•ªèŒ„</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="focusTime">0</div>
                        <div class="stat-label">ä¸“æ³¨åˆ†é’Ÿ</div>
                    </div>
                </div>

                <!-- èƒ½é‡æ¡ -->
                <div class="energy-bar-container">
                    <div class="energy-bar-label">
                        <span>ä»Šæ—¥èƒ½é‡</span>
                        <span id="energyProgress">0/8</span>
                    </div>
                    <div class="energy-bar-track">
                        <div class="energy-bar-fill" id="energyBarFill"></div>
                    </div>
                </div>
            </div>

            <!-- å¿«æ·é“¾æ¥ -->
            <div class="quick-links sidebar-content" id="quickLinksContainer">
                <div class="section-title">ğŸ”— å¸¸ç”¨å·¥å…·</div>
                <div class="links-grid">
                    <a href="https://www.google.com" target="_blank" class="link-card">Google</a>
                    <a href="https://www.notion.so" target="_blank" class="link-card">Notion</a>
                    <a href="https://calendar.google.com" target="_blank" class="link-card">æ—¥å†</a>
                    <a href="https://mail.google.com" target="_blank" class="link-card">é‚®ç®±</a>
                </div>
            </div>

            <!-- å¿«æ·é“¾æ¥åˆ‡æ¢æŒ‰é’®ï¼ˆPAUSEçŠ¶æ€æ˜¾ç¤ºï¼‰ -->
            <button id="quickLinksToggle" class="quick-links-toggle" style="display:none;" onclick="toggleQuickLinks()">ğŸ”§ å·¥å…·</button>

            <!-- å‘¼å¸è®­ç»ƒï¼ˆä»…ä¼‘æ¯æ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <div class="sidebar-breathing">
                <div class="section-title">ğŸŒ¬ï¸ å‘¼å¸ç»ƒä¹ </div>
                <div class="sidebar-breathing-circle" id="sidebarBreathingCircle" onclick="toggleSidebarBreathing()">
                    <span class="sidebar-breathing-text" id="sidebarBreathingText">å¼€å§‹</span>
                </div>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content">
            <!-- ç•ªèŒ„é’Ÿ - ä¸­å¿ƒä½ç½® -->
            <div class="timer-section-center">
                <div class="timer-label">ç•ªèŒ„é’Ÿè®¡æ—¶å™¨</div>
                <div class="timer-circle-container">
                    <svg class="timer-circle-svg" viewBox="0 0 280 280">
                        <circle class="timer-circle-bg" cx="140" cy="140" r="128"></circle>
                        <circle class="timer-circle-progress" id="timerCircle" cx="140" cy="140" r="128"></circle>
                    </svg>
                    <div class="timer-display-overlay">
                        <div class="timer-display" id="timerDisplay">25:00</div>
                    </div>
                </div>
                <div class="timer-buttons">
                    <button class="btn btn-primary" id="startBtn">å¼€å§‹</button>
                    <button class="btn btn-secondary" id="resetBtn">é‡ç½®</button>
                    <!-- FLOWçŠ¶æ€ä¸‹çš„æš‚åœæŒ‰é’® -->
                    <button class="btn btn-danger" id="flowPauseBtn" style="display:none;" onclick="transitionToState(AppState.PAUSE)">æš‚åœ</button>
                </div>
                <div class="timer-presets">
                    <button class="btn btn-secondary" onclick="setTimer(25)">25åˆ†é’Ÿ</button>
                    <button class="btn btn-secondary" onclick="setTimer(5)">5åˆ†é’Ÿ</button>
                    <button class="btn btn-secondary" onclick="setTimer(15)">15åˆ†é’Ÿ</button>
                </div>
            </div>

            <!-- å½“å‰ç›®æ ‡æ˜¾ç¤ºï¼ˆä»…ä¸“æ³¨æ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <div class="focus-current-goal" id="focusCurrentGoal">
                <div class="focus-goal-label">å½“å‰ä¸“æ³¨</div>
                <div class="focus-goal-text" id="focusGoalText">å¼€å§‹å‰è¯·å…ˆè®¾ç½®å½“å‰ç›®æ ‡</div>
            </div>
        </main>
    </div>

    <!-- ç²’å­ç‰¹æ•ˆç”»å¸ƒ -->
    <canvas id="celebrationCanvas"></canvas>

    <!-- ä¾§è¾¹æ è¾¹ç¼˜ç‚¹ï¼ˆFLOWçŠ¶æ€æ˜¾ç¤ºï¼‰ -->
    <div id="sidebarDot" class="sidebar-dot" style="display:none;"></div>

    <script>
        // æ¨¡å¼ç®¡ç†
        let currentMode = 'focus'; // 'focus' æˆ– 'rest'
        const container = document.querySelector('.container');
        const sidebar = document.querySelector('.sidebar');
        const body = document.body;

        function switchToFocusMode() {
            currentMode = 'focus';
            body.classList.remove('rest-mode');
            body.classList.add('focus-mode');
            container.classList.add('sidebar-collapsed');
            sidebar.classList.add('collapsed');

            // åŒæ­¥å½“å‰ç›®æ ‡åˆ°ä¸»å†…å®¹åŒº
            const currentGoalInput = document.getElementById('currentGoal');
            const focusGoalText = document.getElementById('focusGoalText');
            const goalValue = currentGoalInput.value.trim();
            focusGoalText.textContent = goalValue || 'ä¸“æ³¨å½“ä¸‹è¿™ä¸€ä»¶äº‹';
        }

        function switchToRestMode() {
            currentMode = 'rest';
            body.classList.add('rest-mode');
            body.classList.remove('focus-mode');
            container.classList.remove('sidebar-collapsed');
            sidebar.classList.remove('collapsed');
        }

        // ========== å››çŠ¶æ€ç³»ç»Ÿ ==========
        // å®šä¹‰åº”ç”¨çŠ¶æ€
        const AppState = {
            IDLE: 'idle',           // ç©ºé—²æ€ï¼šåˆšæ‰“å¼€é¡µé¢æˆ–å®Œæˆä¸€è½®å·¥ä½œ
            PRE_FOCUS: 'pre-focus', // å‡†å¤‡æ€ï¼šç‚¹å‡»äº†"å¼€å§‹"ï¼Œä½†å°šæœªè¿›å…¥è®¡æ—¶
            FLOW: 'flow',           // å¿ƒæµæ€ï¼šå€’è®¡æ—¶è¿è¡Œä¸­ï¼Œæœ€é«˜æˆ’å¤‡çŠ¶æ€
            PAUSE: 'pause'          // æš‚åœæ€ï¼šç”¨æˆ·ä¸»åŠ¨ä¸­æ–­
        };

        let currentState = AppState.IDLE;

        // è®¡æ—¶å™¨å˜é‡å£°æ˜
        let timerSeconds = 25 * 60;
        let totalSeconds = 25 * 60;
        let timerInterval = null;
        let isRunning = false;

        // çŠ¶æ€è½¬æ¢ä¸»å‡½æ•°
        function transitionToState(newState) {
            if (currentState === newState) return;

            console.log(`State transition: ${currentState} â†’ ${newState}`);

            // ç§»é™¤æ—§çŠ¶æ€ç±»
            Object.values(AppState).forEach(state => {
                document.body.classList.remove(`state-${state}`);
            });

            // æ·»åŠ æ–°çŠ¶æ€ç±»
            document.body.classList.add(`state-${newState}`);
            currentState = newState;

            // æ‰§è¡ŒçŠ¶æ€ç‰¹å®šçš„åˆå§‹åŒ–
            switch(newState) {
                case AppState.IDLE:
                    enterIdleState();
                    break;
                case AppState.FLOW:
                    enterFlowState();
                    break;
                case AppState.PAUSE:
                    enterPauseState();
                    break;
            }
        }

        function enterIdleState() {
            // é‡ç½®UIåˆ°åˆå§‹çŠ¶æ€
            document.body.classList.remove('focus-mode', 'rest-mode');
            container.classList.remove('sidebar-collapsed');
            sidebar.classList.remove('collapsed', 'dimmed');
            document.getElementById('sidebarDot').style.display = 'none';
            document.getElementById('quickLinksToggle').style.display = 'none';
            document.getElementById('quickLinksContainer').style.display = 'grid';

            // é‡ç½®æŒ‰é’®
            startBtn.textContent = 'å¼€å§‹ä¸“æ³¨';
            startBtn.style.display = 'block';

            // æ¸…é™¤è®¡æ—¶å™¨
            clearInterval(timerInterval);
            isRunning = false;
            timerSeconds = 25 * 60;
            totalSeconds = 25 * 60;
            updateTimerDisplay();
        }

        function enterFlowState() {
            // åˆ‡æ¢åˆ°ä¸“æ³¨æ¨¡å¼
            switchToFocusMode();

            // éšè—å¿«æ·é“¾æ¥
            document.getElementById('quickLinksContainer').style.display = 'none';

            // æ˜¾ç¤ºä¾§è¾¹æ è¾¹ç¼˜ç‚¹
            document.getElementById('sidebarDot').style.display = 'block';

            // éšè—å‘¼å¸ç»ƒä¹ 
            document.getElementById('sidebarBreathingCircle').parentElement.style.display = 'none';

            // éšè—å¸¸æ˜¾ç¤ºçš„startBtnï¼Œåªæ˜¾ç¤ºé¼ æ ‡ç§»åŠ¨æ—¶å‡ºç°çš„flowPauseBtn
            startBtn.style.display = 'none';

            // è®¾ç½®é¼ æ ‡æ£€æµ‹
            setupFlowMouseDetection();

            // å¯åŠ¨è®¡æ—¶å™¨å€’è®¡æ—¶
            startTimerCountdown();
        }

        function enterPauseState() {
            // æš‚åœè®¡æ—¶å™¨
            pauseTimerCountdown();

            // æ˜¾ç¤ºä¾§è¾¹æ ï¼ˆå¯äº¤äº’ï¼‰
            switchToRestMode();

            // æ˜¾ç¤ºå¿«æ·é“¾æ¥åˆ‡æ¢æŒ‰é’®
            document.getElementById('quickLinksToggle').style.display = 'block';
            document.getElementById('quickLinksContainer').style.display = 'none';

            // æ˜¾ç¤ºå‘¼å¸ç»ƒä¹ ä½œä¸ºç´§æ€¥æŒ‰é’®
            document.getElementById('sidebarBreathingCircle').parentElement.style.display = 'block';

            // æ›´æ–°æŒ‰é’® - æ¢å¤æ˜¾ç¤ºå¹¶æ›´æ”¹æ–‡æœ¬
            startBtn.style.display = 'block';
            startBtn.textContent = 'ç»§ç»­';

            // æ·»åŠ æš‚åœçŠ¶æ€çš„è§†è§‰æ•ˆæœ
            timerDisplay.classList.add('timer-paused');
        }

        // ========== å¿«æ·é“¾æ¥åˆ‡æ¢åŠŸèƒ½ ==========
        function toggleQuickLinks() {
            const container = document.getElementById('quickLinksContainer');
            const toggle = document.getElementById('quickLinksToggle');

            if (container.style.display === 'none') {
                container.style.display = 'grid';
                toggle.textContent = 'ğŸ”§ æ”¶èµ·å·¥å…·';
            } else {
                container.style.display = 'none';
                toggle.textContent = 'ğŸ”§ å·¥å…·';
            }
        }

        // ========== æ‘©æ“¦åŠ›æœºåˆ¶ï¼šæ”¾å¼ƒçš„å¿ƒç†å‹åŠ› ==========
        let mouseMovementTimeout = null;
        let controlsVisible = false;

        function setupFlowMouseDetection() {
            const timerContainer = document.querySelector('.timer-section-center');
            if (!timerContainer) return;

            timerContainer.addEventListener('mousemove', () => {
                if (currentState === AppState.FLOW) {
                    showFlowControls();
                    clearTimeout(mouseMovementTimeout);
                    mouseMovementTimeout = setTimeout(hideFlowControls, 3000);
                }
            });
        }

        function showFlowControls() {
            if (controlsVisible) return;
            controlsVisible = true;

            const flowPauseBtn = document.getElementById('flowPauseBtn');
            if (flowPauseBtn) {
                flowPauseBtn.style.display = 'block';
                flowPauseBtn.style.animation = 'fadeIn 0.3s ease-out';
            }
        }

        function hideFlowControls() {
            controlsVisible = false;

            const flowPauseBtn = document.getElementById('flowPauseBtn');
            if (flowPauseBtn) {
                flowPauseBtn.style.display = 'none';
            }
        }

        function confirmAbandon() {
            const confirmed = confirm(`ç¡®å®šè¦æ”¾å¼ƒè¿™ ${Math.floor(totalSeconds / 60)} åˆ†é’Ÿçš„åŠªåŠ›å—ï¼Ÿ\n\nç‚¹å‡»"ç¡®å®š"æ”¾å¼ƒï¼Œç‚¹å‡»"å–æ¶ˆ"ç»§ç»­ä¸“æ³¨ã€‚`);

            if (confirmed) {
                // ç”¨æˆ·é€‰æ‹©æ”¾å¼ƒ
                transitionToState(AppState.IDLE);
            } else {
                // ç”¨æˆ·é€‰æ‹©ç»§ç»­
                transitionToState(AppState.FLOW);
            }
        }

        // ========== è®¡æ—¶å™¨è¾…åŠ©å‡½æ•° ==========
        function startTimerCountdown() {
            // æ¸…é™¤ä»»ä½•ç°æœ‰çš„è®¡æ—¶å™¨ï¼Œé˜²æ­¢å¤šä¸ªintervalåŒæ—¶è¿è¡Œ
            if (timerInterval) {
                clearInterval(timerInterval);
            }

            isRunning = true;
            startBtn.textContent = 'æš‚åœ';

            timerInterval = setInterval(() => {
                if (timerSeconds > 0) {
                    timerSeconds--;
                    updateTimerDisplay();
                } else {
                    clearInterval(timerInterval);
                    isRunning = false;
                    startBtn.textContent = 'å¼€å§‹';

                    // æ›´æ–°ç»Ÿè®¡
                    stats.pomodoros++;
                    stats.focusMinutes += Math.floor(totalSeconds / 60);
                    localStorage.setItem('adhd_stats', JSON.stringify(stats));
                    document.getElementById('pomodoroCount').textContent = stats.pomodoros;
                    document.getElementById('focusTime').textContent = stats.focusMinutes;

                    // æ›´æ–°èƒ½é‡æ¡
                    updateEnergyBar();

                    // æ›´æ–°è¿èƒœè®°å½•
                    updateStreak();

                    // è§¦å‘åº†ç¥ç‰¹æ•ˆ
                    triggerCelebration();

                    // ç³»ç»Ÿé€šçŸ¥
                    if (Notification.permission === 'granted') {
                        new Notification('ğŸ‰ ä¸“æ³¨æ—¶é—´ç»“æŸï¼', { body: 'å¤ªæ£’äº†ï¼ä¼‘æ¯ä¸€ä¸‹å§ï¼' });
                    }

                    // è¿”å›IDLEçŠ¶æ€
                    transitionToState(AppState.IDLE);
                }
            }, 1000);
        }

        function pauseTimerCountdown() {
            clearInterval(timerInterval);
            isRunning = false;
        }

        function resumeTimerCountdown() {
            startTimerCountdown();
        }

        const timerDisplay = document.getElementById('timerDisplay');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const timerCircle = document.getElementById('timerCircle');

        // åœ†ç¯è¿›åº¦æ¡è®¾ç½®
        const radius = 128;
        const circumference = 2 * Math.PI * radius;
        timerCircle.style.strokeDasharray = circumference;
        timerCircle.style.strokeDashoffset = 0;

        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            timerDisplay.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;

            // æ›´æ–°åœ†ç¯è¿›åº¦
            const progress = timerSeconds / totalSeconds;
            const offset = circumference * (1 - progress);
            timerCircle.style.strokeDashoffset = offset;
        }

        function startTimer() {
            switch(currentState) {
                case AppState.IDLE:
                    transitionToState(AppState.FLOW);
                    break;
                case AppState.FLOW:
                    transitionToState(AppState.PAUSE);
                    break;
                case AppState.PAUSE:
                    transitionToState(AppState.FLOW);
                    break;
            }
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timerSeconds = 25 * 60;
            totalSeconds = 25 * 60;
            updateTimerDisplay();
            startBtn.textContent = 'å¼€å§‹';
            isRunning = false;
        }

        function setTimer(minutes) {
            clearInterval(timerInterval);
            timerSeconds = minutes * 60;
            totalSeconds = minutes * 60;
            updateTimerDisplay();
            startBtn.textContent = 'å¼€å§‹';
            isRunning = false;
        }

        startBtn.addEventListener('click', startTimer);
        resetBtn.addEventListener('click', resetTimer);

        // ä»»åŠ¡ç®¡ç†åŠŸèƒ½
        let tasks = JSON.parse(localStorage.getItem('adhd_tasks') || '[]');
        const taskList = document.getElementById('taskList');
        const taskInput = document.getElementById('taskInput');

        function renderTasks() {
            taskList.innerHTML = '';
            tasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.className = 'task-item' + (task.done ? ' completed' : '');
                li.innerHTML = `
                    <input type="checkbox" class="task-checkbox"
                           ${task.done ? 'checked' : ''}
                           onchange="toggleTask(${index})">
                    <span>${task.text}</span>
                    <button class="task-delete" onclick="deleteTask(${index})">âœ•</button>
                `;
                taskList.appendChild(li);
            });
        }

        function addTask() {
            const text = taskInput.value.trim();
            if (text) {
                tasks.push({ text, done: false });
                localStorage.setItem('adhd_tasks', JSON.stringify(tasks));
                taskInput.value = '';
                renderTasks();

                // å¦‚æœå½“å‰ç›®æ ‡ä¸ºç©ºï¼Œè‡ªåŠ¨è®¾ç½®ä¸ºç¬¬ä¸€ä¸ªä»»åŠ¡
                const currentGoalInput = document.getElementById('currentGoal');
                if (!currentGoalInput.value.trim()) {
                    currentGoalInput.value = text;
                    localStorage.setItem('adhd_goal', text);
                }
            }
        }

        function toggleTask(index) {
            tasks[index].done = !tasks[index].done;
            localStorage.setItem('adhd_tasks', JSON.stringify(tasks));
            renderTasks();
        }

        function deleteTask(index) {
            tasks.splice(index, 1);
            localStorage.setItem('adhd_tasks', JSON.stringify(tasks));
            renderTasks();
        }

        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTask();
        });

        renderTasks();

        // ç»Ÿè®¡åŠŸèƒ½
        let stats = JSON.parse(localStorage.getItem('adhd_stats') || '{"pomodoros":0,"focusMinutes":0,"date":""}');
        const today = new Date().toDateString();

        if (stats.date !== today) {
            stats = { pomodoros: 0, focusMinutes: 0, date: today };
            localStorage.setItem('adhd_stats', JSON.stringify(stats));
        }

        document.getElementById('pomodoroCount').textContent = stats.pomodoros;
        document.getElementById('focusTime').textContent = stats.focusMinutes;

        // èƒ½é‡æ¡åŠŸèƒ½
        const DAILY_GOAL = 8; // æ¯æ—¥ç›®æ ‡ç•ªèŒ„é’Ÿæ•°é‡
        const energyBarFill = document.getElementById('energyBarFill');
        const energyProgress = document.getElementById('energyProgress');

        function updateEnergyBar() {
            const progress = Math.min(stats.pomodoros / DAILY_GOAL, 1);
            const percentage = progress * 100;

            energyBarFill.style.width = percentage + '%';
            energyProgress.textContent = `${stats.pomodoros}/${DAILY_GOAL}`;

            // å¦‚æœè¾¾åˆ°ç›®æ ‡ï¼Œæ”¹å˜é¢œè‰²
            if (stats.pomodoros >= DAILY_GOAL) {
                energyBarFill.style.background = 'linear-gradient(90deg, #52C788, #27AE60)';
            } else {
                energyBarFill.style.background = 'linear-gradient(90deg, var(--primary), var(--accent))';
            }
        }

        // åˆå§‹åŒ–èƒ½é‡æ¡
        updateEnergyBar();

        // è¿èƒœæœºåˆ¶
        let streakData = JSON.parse(localStorage.getItem('adhd_streak') || '{"days":0,"lastDate":""}');
        const streakDaysEl = document.getElementById('streakDays');
        const todayStreakEl = document.getElementById('todayStreak');

        function updateStreak() {
            const today = new Date().toDateString();
            const yesterday = new Date(Date.now() - 86400000).toDateString();

            // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°çš„ä¸€å¤©
            if (streakData.lastDate !== today) {
                // å¦‚æœæ˜¨å¤©æœ‰å®Œæˆç•ªèŒ„é’Ÿï¼Œè¿ç»­å¤©æ•°+1
                if (streakData.lastDate === yesterday && stats.pomodoros > 0) {
                    streakData.days++;
                } else if (stats.pomodoros > 0) {
                    // å¦‚æœä¸æ˜¯è¿ç»­çš„ï¼Œä½†ä»Šå¤©æœ‰å®Œæˆï¼Œé‡ç½®ä¸º1
                    streakData.days = 1;
                } else {
                    // ä»Šå¤©è¿˜æ²¡å®Œæˆï¼Œä¿æŒåŸæ ·
                    streakData.days = 0;
                }
            }

            // å¦‚æœä»Šå¤©å®Œæˆäº†ç•ªèŒ„é’Ÿï¼Œæ›´æ–°lastDate
            if (stats.pomodoros > 0) {
                streakData.lastDate = today;
                localStorage.setItem('adhd_streak', JSON.stringify(streakData));
            }

            // æ›´æ–°æ˜¾ç¤º
            streakDaysEl.textContent = streakData.days;
            todayStreakEl.textContent = stats.pomodoros;
        }

        // åˆå§‹åŒ–è¿èƒœæ˜¾ç¤º
        updateStreak();

        // Windows å…¨å±€é€šçŸ¥ç³»ç»Ÿ
        if ('Notification' in window) {
            // æ£€æŸ¥å½“å‰æƒé™çŠ¶æ€
            if (Notification.permission === 'default') {
                // è¯·æ±‚é€šçŸ¥æƒé™
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        console.log('é€šçŸ¥æƒé™å·²æˆäºˆ');
                    }
                });
            } else if (Notification.permission === 'granted') {
                console.log('é€šçŸ¥æƒé™å·²å­˜åœ¨');
            }
        } else {
            console.warn('æ­¤æµè§ˆå™¨ä¸æ”¯æŒé€šçŸ¥åŠŸèƒ½');
        }

        // ä¿å­˜å½“å‰ç›®æ ‡
        const currentGoal = document.getElementById('currentGoal');
        currentGoal.value = localStorage.getItem('adhd_goal') || '';
        currentGoal.addEventListener('input', () => {
            localStorage.setItem('adhd_goal', currentGoal.value);
        });

        // ä¾§è¾¹æ å‘¼å¸ç»ƒä¹ åŠŸèƒ½
        let sidebarBreathingActive = false;
        const sidebarBreathingCircle = document.getElementById('sidebarBreathingCircle');
        const sidebarBreathingText = document.getElementById('sidebarBreathingText');

        function toggleSidebarBreathing() {
            if (sidebarBreathingActive) {
                stopSidebarBreathing();
            } else {
                startSidebarBreathing();
            }
        }

        function startSidebarBreathing() {
            sidebarBreathingActive = true;
            sidebarBreathingText.textContent = 'åœæ­¢';
            sidebarBreathe();
        }

        function stopSidebarBreathing() {
            sidebarBreathingActive = false;
            sidebarBreathingCircle.classList.remove('inhale', 'exhale');
            sidebarBreathingText.textContent = 'å¼€å§‹';
        }

        function sidebarBreathe() {
            if (!sidebarBreathingActive) return;

            // å¸æ°” 4ç§’
            sidebarBreathingCircle.classList.add('inhale');
            sidebarBreathingCircle.classList.remove('exhale');
            sidebarBreathingText.textContent = 'å¸æ°”';

            setTimeout(() => {
                if (!sidebarBreathingActive) return;
                // å‘¼æ°” 4ç§’
                sidebarBreathingCircle.classList.remove('inhale');
                sidebarBreathingCircle.classList.add('exhale');
                sidebarBreathingText.textContent = 'å‘¼æ°”';

                setTimeout(() => {
                    if (sidebarBreathingActive) sidebarBreathe();
                }, 4000);
            }, 4000);
        }

        // æ¿€åŠ±è¯­å¥åŠŸèƒ½
        const quotes = [
            "ä¸“æ³¨äºå½“ä¸‹ï¼Œä¸€æ¬¡åªåšä¸€ä»¶äº‹ã€‚",
            "è¿›æ­¥æ¯”å®Œç¾æ›´é‡è¦ã€‚",
            "æ¯ä¸€å°æ­¥éƒ½æ˜¯å‰è¿›ã€‚",
            "ä½ æ¯”ä½ æƒ³è±¡çš„æ›´æœ‰èƒ½åŠ›ã€‚",
            "ä¼‘æ¯ä¸æ˜¯å·æ‡’ï¼Œæ˜¯ä¸ºäº†èµ°æ›´è¿œã€‚",
            "æ¥å—è‡ªå·±çš„èŠ‚å¥ï¼Œä¸å¿…å’Œåˆ«äººæ¯”è¾ƒã€‚",
            "å¼€å§‹æ˜¯æœ€éš¾çš„éƒ¨åˆ†ï¼Œä½ å·²ç»åšåˆ°äº†ã€‚",
            "åˆ†å¿ƒäº†ï¼Ÿæ²¡å…³ç³»ï¼Œé‡æ–°å¼€å§‹å°±å¥½ã€‚",
            "ä»Šå¤©å®Œæˆä¸€ä»¶äº‹ï¼Œå°±æ˜¯èƒœåˆ©ã€‚",
            "ä½ çš„å¤§è„‘åªæ˜¯å·¥ä½œæ–¹å¼ä¸åŒï¼Œä¸æ˜¯æœ‰ç¼ºé™·ã€‚"
        ];

        function newQuote() {
            const quoteEl = document.getElementById('motivationQuote');
            const randomIndex = Math.floor(Math.random() * quotes.length);
            quoteEl.textContent = '"' + quotes[randomIndex] + '"';
        }

        // ç²’å­åº†ç¥ç‰¹æ•ˆç³»ç»Ÿ
        const canvas = document.getElementById('celebrationCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let animationId = null;

        // è®¾ç½® Canvas å°ºå¯¸
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // ç²’å­ç±»
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 8 + 4;
                this.speedX = Math.random() * 6 - 3;
                this.speedY = Math.random() * -15 - 5;
                this.gravity = 0.5;
                this.opacity = 1;
                this.colors = ['#5DADE2', '#52C788', '#E67E22', '#F39C12', '#E74C3C', '#9B59B6'];
                this.color = this.colors[Math.floor(Math.random() * this.colors.length)];
            }

            update() {
                this.speedY += this.gravity;
                this.x += this.speedX;
                this.y += this.speedY;
                this.opacity -= 0.01;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }
// åŠ¨ç”»å¾ªç¯        function animateParticles() {            ctx.clearRect(0, 0, canvas.width, canvas.height);            particles.forEach((particle, index) => {                particle.update();                particle.draw();                // ç§»é™¤é€æ˜åº¦ä¸º0çš„ç²’å­                if (particle.opacity <= 0) {                    particles.splice(index, 1);                }            });            if (particles.length > 0) {                animationId = requestAnimationFrame(animateParticles);            } else {                canvas.style.display = 'none';                cancelAnimationFrame(animationId);            }        }        // è§¦å‘åº†ç¥ç‰¹æ•ˆ        function triggerCelebration() {            canvas.style.display = 'block';            particles = [];            // ä»å±å¹•ä¸­å¿ƒçˆ†å‘ç²’å­            const centerX = canvas.width / 2;            const centerY = canvas.height / 2;            for (let i = 0; i < 150; i++) {                particles.push(new Particle(centerX, centerY));            }            // ä»å±å¹•åº•éƒ¨å‘å°„ç²’å­            for (let i = 0; i < 50; i++) {                const x = Math.random() * canvas.width;                particles.push(new Particle(x, canvas.height));            }            animateParticles();        }
</script>
</body>
</html>
